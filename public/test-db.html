<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALIF SENSE Database Test</title>
</head>
<body>
    <h1>ALIF SENSE Database Test</h1>
    <p>If you can see this, the server is working correctly.</p>
    
    <div id="results"></div>
    
    <script>
        const results = document.getElementById('results');
        
        function log(message) {
            const p = document.createElement('p');
            p.textContent = message;
            results.appendChild(p);
            console.log(message);
        }
        
        // Test localStorage
        try {
            localStorage.setItem('test', 'This is a test');
            log('localStorage test: ' + localStorage.getItem('test'));
        } catch (error) {
            log('localStorage error: ' + error.message);
        }
        
        // Test IndexedDB
        const testIndexedDB = () => {
            try {
                log('Testing IndexedDB...');
                
                if (!window.indexedDB) {
                    log('IndexedDB is not available in this browser');
                    return;
                }
                
                const request = indexedDB.open('testDB', 1);
                
                request.onupgradeneeded = (event) => {
                    log('IndexedDB upgrade needed');
                    const db = event.target.result;
                    const store = db.createObjectStore('testStore', { keyPath: 'id' });
                    store.createIndex('name', 'name', { unique: false });
                };
                
                request.onsuccess = (event) => {
                    log('IndexedDB opened successfully');
                    const db = event.target.result;
                    
                    // Test adding data
                    const transaction = db.transaction(['testStore'], 'readwrite');
                    const store = transaction.objectStore('testStore');
                    
                    const testData = { id: 1, name: 'Test Item' };
                    const addRequest = store.add(testData);
                    
                    addRequest.onsuccess = () => {
                        log('Data added to IndexedDB successfully');
                        
                        // Test reading data
                        const getRequest = store.get(1);
                        
                        getRequest.onsuccess = () => {
                            log('Data read from IndexedDB: ' + JSON.stringify(getRequest.result));
                            db.close();
                        };
                        
                        getRequest.onerror = (e) => {
                            log('Error reading data: ' + e.target.error);
                        };
                    };
                    
                    addRequest.onerror = (e) => {
                        log('Error adding data: ' + e.target.error);
                    };
                    
                    transaction.oncomplete = () => {
                        log('Transaction completed');
                    };
                };
                
                request.onerror = (event) => {
                    log('IndexedDB error: ' + event.target.error);
                };
            } catch (error) {
                log('IndexedDB test error: ' + error.message);
            }
        };
        
        testIndexedDB();
    </script>
</body>
</html>
